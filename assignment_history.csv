from pathlib import Path

history_file = Path("assignment_history.csv")

if history_file.exists():
    history_df = pd.read_csv(history_file)
    history_df = pd.concat([history_df, df], ignore_index=True)
else:
    history_df = df

history_df.to_csv(history_file, index=False)